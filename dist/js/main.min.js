!function(e){function t(t){for(var o,r,s=t[0],i=t[1],l=0,c=[];l<s.length;l++)r=s[l],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&c.push(n[r][0]),n[r]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);for(a&&a(t);c.length;)c.shift()()}var o={},n={3:0};function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.e=function(e){var t=[],o=n[e];if(0!==o)if(o)t.push(o[2]);else{var s=new Promise((function(t,r){o=n[e]=[t,r]}));t.push(o[2]=s);var i,l=document.createElement("script");l.charset="utf-8",l.timeout=120,r.nc&&l.setAttribute("nonce",r.nc),l.src=function(e){return r.p+"js/"+({0:"boundaries/geomaps-geojson",1:"boundaries/josm-geojson",2:"boundaries/naturalearth-geojson",4:"codes"}[e]||e)+".min.js"}(e);var a=new Error;i=function(t){l.onerror=l.onload=null,clearTimeout(c);var o=n[e];if(0!==o){if(o){var r=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;a.message="Loading chunk "+e+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,o[1](a)}n[e]=void 0}};var c=setTimeout((function(){i({type:"timeout",target:l})}),12e4);l.onerror=l.onload=i,document.head.appendChild(l)}return Promise.all(t)},r.m=e,r.c=o,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="dist/",r.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp=window.webpackJsonp||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var a=i;r(r.s=2)}([,function(e,t,o){var n={"./geomaps.geojson":[3,0],"./josm.geojson":[4,1],"./naturalearth.geojson":[5,2]};function r(e){if(!o.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return o.e(t[1]).then((function(){return o.t(r,3)}))}r.keys=function(){return Object.keys(n)},r.id=1,e.exports=r},function(e,t,o){"use strict";o.r(t);const n=L.Control.extend({options:{position:"topleft"},onAdd(e){const t=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return t.style.cursor="pointer",t.style.backgroundColor="white",t.innerHTML='<img alt="take a screenshot" src="images/camera.svg"></img>',t.style.height="24px",t.onclick=()=>{t.style.backgroundColor="#ffa726",leafletImage(e,(e,o)=>{const n=document.createElement("a");n.href=o.toDataURL(),n.download="blacklistr-screenshot.png",document.getElementById("images").innerHTML="",document.getElementById("images").appendChild(n),n.click(),t.style.backgroundColor="white"})},t}}),r=L.Control.extend({options:{position:"topleft"},onAdd(e){const t=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return t.style.cursor="pointer",t.style.backgroundColor="white",t.innerHTML='<img alt="reload map" src="images/autorenew.svg"></img>',t.style.height="24px",t.onclick=()=>{e.setView([30,0],2)},t}}),s=L.Control.extend({options:{position:"topleft"},onAdd(){const e=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return e.style.cursor="pointer",e.style.backgroundColor="white",e.innerHTML='<img alt="open settings" src="images/settings.svg"></img>',e.style.height="24px",e.onclick=()=>{const e=document.getElementById("settings"),[t]=document.getElementsByClassName("close");e.style.display="block",t.onclick=function(){e.style.display="none"},window.onclick=function(t){t.target===e&&(e.style.display="none")}},e}}),i=L.Control.extend({options:{position:"topright"},onAdd(){const e=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return e.style.cursor="pointer",e.style.backgroundColor="white",e.innerHTML='<img alt="hide editor" src="images/keyboard-close.svg"></img>',e.style.height="24px",e.onclick=()=>{document.body.dispatchEvent(new Event("toggle-side"))},e}}),l="all except",a="only",c={ALL_EXCEPT:[l,"hide","except","not","disable","blacklist"],ONLY:[a,"show","just","in","enable","whitelist"]},u="blacklist",d="whitelist",p="none";function m(e){const t={countries:[],comments:{},mode:null};if(!e)return t;const o=e.split("\n");if(!o)return t;for(let e=0;e<o.length;e++){if(o[e]=o[e].trim(),o[e].startsWith("//")||""===o[e]||"\n"===o[e])continue;if(!t.mode){if(new RegExp(`^(${c.ALL_EXCEPT.join("|")})`).test(o[e].toLowerCase())){t.mode=u;continue}if(new RegExp(`^(${c.ONLY.join("|")})`).test(o[e].toLowerCase())){t.mode=d;continue}t.mode=p}const[n,r]=o[e].split(/\/\/(.+)?/,2),s=f(n.split(","));t.countries.push(...s),r&&(t.comments[s[s.length-1]]=r.replace(" ",""))}return t}function f(e){if("string"==typeof e)return e.replace(/(\t|")/g,"").replace(/\/\//g,"//").trim();if(Array.isArray(e)){const t=[];for(let o=0;o<e.length;o++)""===e[o]||e[o].length<2||!e[o].match("[a-zA-Z]+")||t.push(f(e[o]));return t}}function g(e,t){let o,n;if(e.match(/(Countries\.noneExcept|NoCountriesExcept)/))o=d;else{if(!e.match(/(Countries\.allExcept|AllCountriesExcept)/))throw new TypeError("This file is not valid because it contains no black- or whitelist!");o=u}t?n=new RegExp(/Countries\.(?:noneExcept|allExcept)\([\s\S]*?\{([\s\S]*?)?\}\)/):(e=e.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,""),n=new RegExp(/(?:Countries\.(?:noneExcept|allExcept)|NoCountriesExcept|AllCountriesExcept)\(([\s\S]*?)\)/));const r=f(n.exec(e)[1].split("\n"));let s=o===d?a:l;return s+="\n",s+=r.join("\n"),s}let h,y;const w={RED:{fillColor:"#c62828",weight:1.2,fillOpacity:.8},ORANGE:{fillColor:"#ffa726",weight:1.2,fillOpacity:.8},GREEN:{fillColor:"#2e7d32",weight:1.2,fillOpacity:.8},DEFAULT:{fillColor:"#3388ff",weight:1.2,fillOpacity:.8},INVISIBLE:{fillOpacity:0,weight:0}},b={screenshot:new n,reset:new r,settings:new s,hide:new i};function E(){h.addControl(b.screenshot),h.addControl(b.reset),h.addControl(b.settings)}const v={boundaries:"josm",content:"all except\nNL, // https://forum.openstreetmap.org/viewtopic.php?id=60356\nDK, // https://lists.openstreetmap.org/pipermail/talk-dk/2017-November/004898.html\nNO, // https://forum.openstreetmap.org/viewtopic.php?id=60357\nCZ, // https://lists.openstreetmap.org/pipermail/talk-cz/2017-November/017901.html\nIT  // https://lists.openstreetmap.org/pipermail/talk-it/2018-July/063712.html\n"};function C(e){return window.localStorage.getItem(e)||v[e]}function x(e,t){window.localStorage.setItem(e,t)}let k=[];const j=CodeMirror(document.getElementById("codemirror-container"),{placeholder:"Input all country codes seperated by a comma or line break (comments are allowed too)",mode:"javascript",theme:"material",autofocus:!0,lineNumbers:!0,lineWrapping:!0,smartIndent:!1});function O(){const e=C("boundaries");return o(1)(`./${e}.geojson`).then(e=>{return t=e.default,y.clearLayers(),void y.addData(t);var t})}function I(){const e=m(j.getValue());e.toString(),function(e){y.eachLayer(t=>{let o=w.INVISIBLE;if(e.countries.map(e=>e.toUpperCase()).includes(t.feature.properties.code))switch(e.mode){case u:o=w.RED;break;case d:o=w.GREEN;break;case p:o=w.DEFAULT}t.setStyle(o)})}(e),function(e){let t="";e.mode===u?t+="Blacklisted in ":e.mode===d&&(t+="Whitelisted in ");e.countries.forEach(o=>{t+=k[o.toUpperCase()]||o,e.countries.indexOf(o)!==e.countries.length-1&&(t+=", ")}),document.getElementById("country-list").innerHTML=t}(e)}j.on("change",()=>{x("content",j.getValue()),I()}),document.getElementById("map").addEventListener("change-boundaries",()=>{O().then(()=>I())}),document.body.addEventListener("toggle-side",()=>{!function(){document.getElementById("map").className.includes("s8")?(document.getElementById("map").classList.remove("s8"),document.getElementById("map").classList.add("s12"),h.removeControl(b.screenshot),h.removeControl(b.reset),h.removeControl(b.settings)):(document.getElementById("map").classList.remove("s12"),document.getElementById("map").classList.add("s8"),E());h._onResize(),j.refresh()}()}),async function(){var e;e=e=>{const t=m(j.getValue()),o=t.countries.indexOf(e);o>-1?t.countries.splice(o,1):t.countries.push(e),j.setValue(function(e){let t="";return e.mode===u?t+=`${l}\n`:e.mode===d&&(t+=`${a}\n`),e.countries.forEach((o,n)=>{t+=o,n!==e.countries.length-1&&(t+=",");const r=e.comments[o];r&&(t+=` // ${r}\n`)}),t}(t))},h=L.map("map",{minZoom:2,maxZoom:18,preferCanvas:!0,zoomControl:!1,maxBounds:[[90,180],[-90,-180]]}).setView([30,0],2),L.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.osm.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attribution/">CartoDB</a>'}).addTo(h),y=L.geoJSON(null,{style:w.INVISIBLE,filter:e=>null!=e.properties.code,onEachFeature(t,o){o.on({click(t){e(t.target.feature.properties.code)}})}}).addTo(h),h.addControl(b.hide),E(),function(){const e=C("boundaries");document.querySelector(`input[type="radio"][name="boundaries"][value="${e}"]`).checked=!0,document.querySelectorAll('input[type="radio"][name="boundaries"]').forEach(e=>{e.addEventListener("change",e=>{x("boundaries",e.target.value),document.getElementById("map").dispatchEvent(new Event("change-boundaries"))})})}(),await O(),await o.e(4).then(o.t.bind(null,0,3)).then(e=>k=e.default);const t=new URL(window.location.href),n=t.searchParams.get("data"),r=t.searchParams.get("file"),s=t.searchParams.get("streetcomplete");if(n)j.setValue(n);else if(r)j.setValue(await fetch(r).then(e=>e.text()));else if(s){let e=s;if(!function(e){return/^(?:\w+:)?\/\/([^\s\.]+\.\S{2}|localhost[\:?\d]*)\S*$/.test(e)}(s)){e="https://raw.githubusercontent.com/westnordost/StreetComplete/master/app/src/main/java/de/westnordost/streetcomplete/quests/"+s}const t=await fetch(e).then(e=>e.text()),o=e.split(".").pop();"java"===o?j.setValue(g(t,!0)):"kt"===o&&j.setValue(g(t,!1))}else j.setValue(C("content"))}()}]);