(()=>{var e,t,o,n,r={121:(e,t,o)=>{var n={"./geomaps.geojson":[32,442],"./josm.geojson":[129,236],"./naturalearth.geojson":[335,154]};function r(e){if(!o.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return o.e(t[1]).then((()=>o.t(r,17)))}r.keys=()=>Object.keys(n),r.id=121,e.exports=r}},s={};function a(e){var t=s[e];if(void 0!==t)return t.exports;var o=s[e]={exports:{}};return r[e](o,o.exports,a),o.exports}a.m=r,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(o,n){if(1&n&&(o=this(o)),8&n)return o;if("object"==typeof o&&o){if(4&n&&o.__esModule)return o;if(16&n&&"function"==typeof o.then)return o}var r=Object.create(null);a.r(r);var s={};e=e||[null,t({}),t([]),t(t)];for(var i=2&n&&o;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((e=>s[e]=()=>o[e]));return s.default=()=>o,a.d(r,s),r},a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,o)=>(a.f[o](e,t),t)),[])),a.u=e=>"js/"+{154:"boundaries/naturalearth-geojson",236:"boundaries/josm-geojson",428:"codes",442:"boundaries/geomaps-geojson"}[e]+".min.js",a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},n="blacklistr:",a.l=(e,t,r,s)=>{if(o[e])o[e].push(t);else{var i,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==n+r){i=u;break}}i||(l=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",n+r),i.src=e),o[e]=[t];var p=(t,n)=>{i.onerror=i.onload=null,clearTimeout(m);var r=o[e];if(delete o[e],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((e=>e(n))),t)return t(n)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),l&&document.head.appendChild(i)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="dist/",(()=>{var e={179:0};a.f.j=(t,o)=>{var n=a.o(e,t)?e[t]:void 0;if(0!==n)if(n)o.push(n[2]);else{var r=new Promise(((o,r)=>n=e[t]=[o,r]));o.push(n[2]=r);var s=a.p+a.u(t),i=new Error;a.l(s,(o=>{if(a.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var r=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;i.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",i.name="ChunkLoadError",i.type=r,i.request=s,n[1](i)}}),"chunk-"+t,t)}};var t=(t,o)=>{var n,r,[s,i,l]=o,c=0;if(s.some((t=>0!==e[t]))){for(n in i)a.o(i,n)&&(a.m[n]=i[n]);l&&l(a)}for(t&&t(o);c<s.length;c++)r=s[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0},o=self.webpackChunkblacklistr=self.webpackChunkblacklistr||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),(()=>{"use strict";const e=L.Control.extend({options:{position:"topleft"},onAdd(e){const t=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return t.style.cursor="pointer",t.style.backgroundColor="white",t.innerHTML='<img alt="take a screenshot" src="images/camera.svg"></img>',t.style.height="24px",t.onclick=()=>{t.style.backgroundColor="#ffa726",leafletImage(e,((e,o)=>{const n=document.createElement("a");n.href=o.toDataURL(),n.download="blacklistr-screenshot.png",document.getElementById("images").innerHTML="",document.getElementById("images").appendChild(n),n.click(),t.style.backgroundColor="white"}))},t}}),t=L.Control.extend({options:{position:"topleft"},onAdd(e){const t=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return t.style.cursor="pointer",t.style.backgroundColor="white",t.innerHTML='<img alt="reload map" src="images/autorenew.svg"></img>',t.style.height="24px",t.onclick=()=>{e.setView([30,0],2)},t}}),o=L.Control.extend({options:{position:"topleft"},onAdd(){const e=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return e.style.cursor="pointer",e.style.backgroundColor="white",e.innerHTML='<img alt="open settings" src="images/settings.svg"></img>',e.style.height="24px",e.onclick=()=>{const e=document.getElementById("settings"),[t]=document.getElementsByClassName("close");e.style.display="block",t.onclick=function(){e.style.display="none"},window.onclick=function(t){t.target===e&&(e.style.display="none")}},e}}),n=L.Control.extend({options:{position:"topright"},onAdd(){const e=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return e.style.cursor="pointer",e.style.backgroundColor="white",e.innerHTML='<img alt="hide editor" src="images/keyboard-close.svg"></img>',e.style.height="24px",e.onclick=()=>{document.body.dispatchEvent(new Event("toggle-side"))},e}}),r="all except",s="only",i={ALL_EXCEPT:[r,"hide","except","not","disable","blacklist"],ONLY:[s,"show","just","in","enable","whitelist"]},l="blacklist",c="whitelist",d="none";function u(e){const t={countries:[],comments:{},mode:null};if(!e)return t;const o=e.split("\n");if(!o)return t;for(let e=0;e<o.length;e++){if(o[e]=o[e].trim(),o[e].startsWith("//")||""===o[e]||"\n"===o[e])continue;if(!t.mode){if(new RegExp(`^(${i.ALL_EXCEPT.join("|")})`).test(o[e].toLowerCase())){t.mode=l;continue}if(new RegExp(`^(${i.ONLY.join("|")})`).test(o[e].toLowerCase())){t.mode=c;continue}t.mode=d}const[n,r]=o[e].split(/\/\/(.+)?/,2),s=p(n.split(","));t.countries.push(...s),r&&(t.comments[s[s.length-1]]=r.replace(" ",""))}return t}function p(e){if("string"==typeof e)return e.replace(/(\t|")/g,"").replace(/\/\//g,"//").trim();if(Array.isArray(e)){const t=[];for(let o=0;o<e.length;o++)""===e[o]||e[o].length<2||!e[o].match("[a-zA-Z]+")||t.push(p(e[o]));return t}}function m(e,t){let o,n;if(e.match(/(Countries\.noneExcept|NoCountriesExcept)/))o=c;else{if(!e.match(/(Countries\.allExcept|AllCountriesExcept)/))throw new TypeError("This file is not valid because it contains no black- or whitelist!");o=l}t?n=new RegExp(/Countries\.(?:noneExcept|allExcept)\([\s\S]*?\{([\s\S]*?)?\}\)/):(e=e.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,""),n=new RegExp(/(?:Countries\.(?:noneExcept|allExcept)|NoCountriesExcept|AllCountriesExcept)\(([\s\S]*?)\)/));const a=p(n.exec(e)[1].split("\n"));let i=o===c?s:r;return i+="\n",i+=a.join("\n"),i}let f,g;const h={RED:{fillColor:"#c62828",weight:1.2,fillOpacity:.8},ORANGE:{fillColor:"#ffa726",weight:1.2,fillOpacity:.8},GREEN:{fillColor:"#2e7d32",weight:1.2,fillOpacity:.8},DEFAULT:{fillColor:"#3388ff",weight:1.2,fillOpacity:.8},INVISIBLE:{fillOpacity:0,weight:0}},y={screenshot:new e,reset:new t,settings:new o,hide:new n};function b(){f.addControl(y.screenshot),f.addControl(y.reset),f.addControl(y.settings)}const w={boundaries:"josm",content:"all except\nNL, // https://forum.openstreetmap.org/viewtopic.php?id=60356\nDK, // https://lists.openstreetmap.org/pipermail/talk-dk/2017-November/004898.html\nNO, // https://forum.openstreetmap.org/viewtopic.php?id=60357\nCZ, // https://lists.openstreetmap.org/pipermail/talk-cz/2017-November/017901.html\nIT  // https://lists.openstreetmap.org/pipermail/talk-it/2018-July/063712.html\n"};function v(e){return window.localStorage.getItem(e)||w[e]}function E(e,t){window.localStorage.setItem(e,t)}let C=[];const k=CodeMirror(document.getElementById("codemirror-container"),{placeholder:"Input all country codes seperated by a comma or line break (comments are allowed too)",mode:"javascript",theme:"material",autofocus:!0,lineNumbers:!0,lineWrapping:!0,smartIndent:!1});function x(){const e=v("boundaries");return a(121)(`./${e}.geojson`).then((e=>{return t=e.default,g.clearLayers(),void g.addData(t);var t}))}function j(){const e=u(k.getValue());e.toString(),function(e){g.eachLayer((t=>{let o=h.INVISIBLE;if(e.countries.map((e=>e.toUpperCase())).includes(t.feature.properties.code))switch(e.mode){case l:o=h.RED;break;case c:o=h.GREEN;break;case d:o=h.DEFAULT}t.setStyle(o)}))}(e),function(e){let t="";e.mode===l?t+="Blacklisted in ":e.mode===c&&(t+="Whitelisted in "),e.countries.forEach((o=>{t+=C[o.toUpperCase()]||o,e.countries.indexOf(o)!==e.countries.length-1&&(t+=", ")})),document.getElementById("country-list").innerHTML=t}(e)}k.on("change",(()=>{E("content",k.getValue()),j()})),document.getElementById("map").addEventListener("change-boundaries",(()=>{x().then((()=>j()))})),document.body.addEventListener("toggle-side",(()=>{document.getElementById("map").className.includes("s8")?(document.getElementById("map").classList.remove("s8"),document.getElementById("map").classList.add("s12"),f.removeControl(y.screenshot),f.removeControl(y.reset),f.removeControl(y.settings)):(document.getElementById("map").classList.remove("s12"),document.getElementById("map").classList.add("s8"),b()),f._onResize(),k.refresh()})),async function(){var e;e=e=>{const t=u(k.getValue()),o=t.countries.indexOf(e);o>-1?t.countries.splice(o,1):t.countries.push(e),k.setValue(function(e){let t="";return e.mode===l?t+=`${r}\n`:e.mode===c&&(t+=`${s}\n`),e.countries.forEach(((o,n)=>{t+=o,n!==e.countries.length-1&&(t+=",");const r=e.comments[o];r&&(t+=` // ${r}\n`)})),t}(t))},f=L.map("map",{minZoom:2,maxZoom:18,preferCanvas:!0,zoomControl:!1,maxBounds:[[90,180],[-90,-180]]}).setView([30,0],2),L.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.osm.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attribution/">CartoDB</a>'}).addTo(f),g=L.geoJSON(null,{style:h.INVISIBLE,filter:e=>null!=e.properties.code,onEachFeature(t,o){o.on({click(t){e(t.target.feature.properties.code)}})}}).addTo(f),f.addControl(y.hide),b(),function(){const e=v("boundaries");document.querySelector(`input[type="radio"][name="boundaries"][value="${e}"]`).checked=!0,document.querySelectorAll('input[type="radio"][name="boundaries"]').forEach((e=>{e.addEventListener("change",(e=>{E("boundaries",e.target.value),document.getElementById("map").dispatchEvent(new Event("change-boundaries"))}))}))}(),await x(),await a.e(428).then(a.t.bind(a,609,17)).then((e=>C=e.default));const t=new URL(window.location.href),o=t.searchParams.get("data"),n=t.searchParams.get("file"),i=t.searchParams.get("streetcomplete");if(o)k.setValue(o);else if(n)k.setValue(await fetch(n).then((e=>e.text())));else if(i){let e=i;(function(e){return/^(?:\w+:)?\/\/([^\s\.]+\.\S{2}|localhost[\:?\d]*)\S*$/.test(e)})(i)||(e="https://raw.githubusercontent.com/westnordost/StreetComplete/master/app/src/main/java/de/westnordost/streetcomplete/quests/"+i);const t=await fetch(e).then((e=>e.text())),o=e.split(".").pop();"java"===o?k.setValue(m(t,!0)):"kt"===o&&k.setValue(m(t,!1))}else k.setValue(v("content"))}()})()})();