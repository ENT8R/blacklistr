(()=>{var e,t,o,n,r={381(e,t,o){var n={"./geomaps.geojson":[894,936],"./josm.geojson":[99,71],"./naturalearth.geojson":[495,923]};function r(e){if(!o.o(n,e))return Promise.resolve().then(()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=n[e],r=t[0];return o.e(t[1]).then(()=>o.t(r,17))}r.keys=()=>Object.keys(n),r.id=381,e.exports=r}},s={};function i(e){var t=s[e];if(void 0!==t)return t.exports;var o=s[e]={exports:{}};return r[e](o,o.exports,i),o.exports}i.m=r,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(o,n){if(1&n&&(o=this(o)),8&n)return o;if("object"==typeof o&&o){if(4&n&&o.__esModule)return o;if(16&n&&"function"==typeof o.then)return o}var r=Object.create(null);i.r(r);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&n&&o;("object"==typeof a||"function"==typeof a)&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach(e=>s[e]=()=>o[e]);return s.default=()=>o,i.d(r,s),r},i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce((t,o)=>(i.f[o](e,t),t),[])),i.u=e=>"js/"+{71:"boundaries/josm-geojson",463:"codes",923:"boundaries/naturalearth-geojson",936:"boundaries/geomaps-geojson"}[e]+".min.js",i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},n="blacklistr:",i.l=(e,t,r,s)=>{if(o[e])o[e].push(t);else{var a,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==n+r){a=u;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",n+r),a.src=e),o[e]=[t];var p=(t,n)=>{a.onerror=a.onload=null,clearTimeout(m);var r=o[e];if(delete o[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach(e=>e(n)),t)return t(n)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),l&&document.head.appendChild(a)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="dist/",(()=>{var e={792:0};i.f.j=(t,o)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)o.push(n[2]);else{var r=new Promise((o,r)=>n=e[t]=[o,r]);o.push(n[2]=r);var s=i.p+i.u(t),a=new Error;i.l(s,o=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var r=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,n[1](a)}},"chunk-"+t,t)}};var t=(t,o)=>{var n,r,[s,a,l]=o,c=0;if(s.some(t=>0!==e[t])){for(n in a)i.o(a,n)&&(i.m[n]=a[n]);l&&l(i)}for(t&&t(o);c<s.length;c++)r=s[c],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0},o=self.webpackChunkblacklistr=self.webpackChunkblacklistr||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),(()=>{"use strict";const e=L.Control.extend({options:{position:"topleft"},onAdd(e){const t=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return t.style.cursor="pointer",t.style.backgroundColor="white",t.innerHTML='<img alt="take a screenshot" src="images/camera.svg"></img>',t.style.height="24px",t.onclick=()=>{t.style.backgroundColor="#ffa726",leafletImage(e,(e,o)=>{const n=document.createElement("a");n.href=o.toDataURL(),n.download="blacklistr-screenshot.png",document.getElementById("images").innerHTML="",document.getElementById("images").appendChild(n),n.click(),t.style.backgroundColor="white"})},t}}),t=L.Control.extend({options:{position:"topleft"},onAdd(e){const t=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return t.style.cursor="pointer",t.style.backgroundColor="white",t.innerHTML='<img alt="reload map" src="images/autorenew.svg"></img>',t.style.height="24px",t.onclick=()=>{e.setView([30,0],2)},t}}),o=L.Control.extend({options:{position:"topleft"},onAdd(){const e=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return e.style.cursor="pointer",e.style.backgroundColor="white",e.innerHTML='<img alt="open settings" src="images/settings.svg"></img>',e.style.height="24px",e.onclick=()=>{const e=document.getElementById("settings"),[t]=document.getElementsByClassName("close");e.style.display="block",t.onclick=function(){e.style.display="none"},window.onclick=function(t){t.target===e&&(e.style.display="none")}},e}}),n=L.Control.extend({options:{position:"topright"},onAdd(){const e=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return e.style.cursor="pointer",e.style.backgroundColor="white",e.innerHTML='<img alt="hide editor" src="images/keyboard-close.svg"></img>',e.style.height="24px",e.onclick=()=>{document.body.dispatchEvent(new Event("toggle-side"))},e}}),r="all except",s="only",a={ALL_EXCEPT:[r,"hide","except","not","disable","blacklist"],ONLY:[s,"show","just","in","enable","whitelist"]},l="blacklist",c="whitelist",d="none";function u(e){const t={countries:[],comments:{},mode:null};if(!e)return t;const o=e.split("\n");if(!o)return t;for(let e=0;e<o.length;e++){if(o[e]=o[e].trim(),o[e].startsWith("//")||""===o[e]||"\n"===o[e])continue;if(!t.mode){if(new RegExp(`^(${a.ALL_EXCEPT.join("|")})`).test(o[e].toLowerCase())){t.mode=l;continue}if(new RegExp(`^(${a.ONLY.join("|")})`).test(o[e].toLowerCase())){t.mode=c;continue}t.mode=d}const[n,r]=o[e].split(/\/\/(.+)?/,2),s=p(n.split(","));t.countries.push(...s),r&&(t.comments[s[s.length-1]]=r.replace(" ",""))}return t}function p(e){if("string"==typeof e)return e.replace(/(\t|")/g,"").replace(/\/\//g,"//").trim();if(Array.isArray(e)){const t=[];for(let o=0;o<e.length;o++)""===e[o]||e[o].length<2||!e[o].match("[a-zA-Z]+")||t.push(p(e[o]));return t}}function m(e,t){let o,n;if(e.match(/(Countries\.noneExcept|NoCountriesExcept)/))o=c;else{if(!e.match(/(Countries\.allExcept|AllCountriesExcept)/))throw new TypeError("This file is not valid because it contains no black- or whitelist!");o=l}t?n=new RegExp(/Countries\.(?:noneExcept|allExcept)\([\s\S]*?\{([\s\S]*?)?\}\)/):(e=e.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,""),n=new RegExp(/(?:Countries\.(?:noneExcept|allExcept)|NoCountriesExcept|AllCountriesExcept)\(([\s\S]*?)\)/));const i=p(n.exec(e)[1].split("\n"));let a=o===c?s:r;return a+="\n",a+=i.join("\n"),a}let f,g;const h={RED:{fillColor:"#c62828",weight:1.2,fillOpacity:.8},ORANGE:{fillColor:"#ffa726",weight:1.2,fillOpacity:.8},GREEN:{fillColor:"#2e7d32",weight:1.2,fillOpacity:.8},DEFAULT:{fillColor:"#3388ff",weight:1.2,fillOpacity:.8},INVISIBLE:{fillOpacity:0,weight:0}},y={screenshot:new e,reset:new t,settings:new o,hide:new n};function b(){f.addControl(y.screenshot),f.addControl(y.reset),f.addControl(y.settings)}const w={boundaries:"josm",content:"all except\nNL, // https://forum.openstreetmap.org/viewtopic.php?id=60356\nDK, // https://lists.openstreetmap.org/pipermail/talk-dk/2017-November/004898.html\nNO, // https://forum.openstreetmap.org/viewtopic.php?id=60357\nCZ, // https://lists.openstreetmap.org/pipermail/talk-cz/2017-November/017901.html\nIT  // https://lists.openstreetmap.org/pipermail/talk-it/2018-July/063712.html\n"};function E(e){return window.localStorage.getItem(e)||w[e]}function v(e,t){window.localStorage.setItem(e,t)}let C=[];const k=CodeMirror(document.getElementById("codemirror-container"),{placeholder:"Input all country codes seperated by a comma or line break (comments are allowed too)",mode:"javascript",theme:"material",autofocus:!0,lineNumbers:!0,lineWrapping:!0,smartIndent:!1});function x(){const e=E("boundaries");return i(381)(`./${e}.geojson`).then(e=>{return t=e.default,g.clearLayers(),void g.addData(t);var t})}function j(){const e=u(k.getValue());e.toString(),function(e){g.eachLayer(t=>{let o=h.INVISIBLE;if(e.countries.map(e=>e.toUpperCase()).includes(t.feature.properties.code))switch(e.mode){case l:o=h.RED;break;case c:o=h.GREEN;break;case d:o=h.DEFAULT}t.setStyle(o)})}(e),function(e){let t="";e.mode===l?t+="Blacklisted in ":e.mode===c&&(t+="Whitelisted in "),e.countries.forEach(o=>{t+=C[o.toUpperCase()]||o,e.countries.indexOf(o)!==e.countries.length-1&&(t+=", ")}),document.getElementById("country-list").innerHTML=t}(e)}k.on("change",()=>{v("content",k.getValue()),j()}),document.getElementById("map").addEventListener("change-boundaries",()=>{x().then(()=>j())}),document.body.addEventListener("toggle-side",()=>{document.getElementById("map").className.includes("s8")?(document.getElementById("map").classList.remove("s8"),document.getElementById("map").classList.add("s12"),f.removeControl(y.screenshot),f.removeControl(y.reset),f.removeControl(y.settings)):(document.getElementById("map").classList.remove("s12"),document.getElementById("map").classList.add("s8"),b()),f._onResize(),k.refresh()}),async function(){var e;e=e=>{const t=u(k.getValue()),o=t.countries.indexOf(e);o>-1?t.countries.splice(o,1):t.countries.push(e),k.setValue(function(e){let t="";return e.mode===l?t+=`${r}\n`:e.mode===c&&(t+=`${s}\n`),e.countries.forEach((o,n)=>{t+=o,n!==e.countries.length-1&&(t+=",");const r=e.comments[o];r&&(t+=` // ${r}\n`)}),t}(t))},f=L.map("map",{minZoom:2,maxZoom:18,preferCanvas:!0,zoomControl:!1,maxBounds:[[90,180],[-90,-180]]}).setView([30,0],2),L.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.osm.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attribution/">CartoDB</a>'}).addTo(f),g=L.geoJSON(null,{style:h.INVISIBLE,filter:e=>null!=e.properties.code,onEachFeature(t,o){o.on({click(t){e(t.target.feature.properties.code)}})}}).addTo(f),f.addControl(y.hide),b(),function(){const e=E("boundaries");document.querySelector(`input[type="radio"][name="boundaries"][value="${e}"]`).checked=!0,document.querySelectorAll('input[type="radio"][name="boundaries"]').forEach(e=>{e.addEventListener("change",e=>{v("boundaries",e.target.value),document.getElementById("map").dispatchEvent(new Event("change-boundaries"))})})}(),await x(),await i.e(463).then(i.t.bind(i,442,17)).then(e=>C=e.default);const t=new URL(window.location.href),o=t.searchParams.get("data"),n=t.searchParams.get("file"),a=t.searchParams.get("streetcomplete");if(o)k.setValue(o);else if(n)k.setValue(await fetch(n).then(e=>e.text()));else if(a){let e=a;(function(e){return/^(?:\w+:)?\/\/([^\s\.]+\.\S{2}|localhost[\:?\d]*)\S*$/.test(e)})(a)||(e="https://raw.githubusercontent.com/streetcomplete/StreetComplete/master/app/src/androidMain/kotlin/de/westnordost/streetcomplete/quests/"+a);const t=await fetch(e).then(e=>e.text()),o=e.split(".").pop();"java"===o?k.setValue(m(t,!0)):"kt"===o&&k.setValue(m(t,!1))}else k.setValue(E("content"))}()})()})();